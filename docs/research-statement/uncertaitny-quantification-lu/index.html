<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>4DVarNet-LU: An neural ensemble DA model for uncertainty quantification. | Home</title>
<meta name=keywords content="machine learning,neural networks,uncertainty quantification,AI">
<meta name=description content="Can an ensemble based on location-uncertainty generate a reliable ensemble in neural DA?">
<meta name=author content="Me">
<link rel=canonical href=https://shashankkroy.github.io/research-statement/uncertaitny-quantification-lu/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.f3a5fcf1a2ed223c5f9f0e42ad1a03f290d7f781cfb741dbede89bcb6f8be329.css integrity="sha256-86X88aLtIjxfnw5CrRoD8pDX94HPt0Hb7eiby2+L4yk=" rel="preload stylesheet" as=style>
<link rel=icon href=https://shashankkroy.github.io/favicon.ico>
<link rel=apple-touch-icon href=https://shashankkroy.github.io/apple-touch-icon.png>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-M628446BVJ"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-M628446BVJ',{anonymize_ip:!1})}</script>
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:title content="4DVarNet-LU: An neural ensemble DA model for uncertainty quantification. | Home">
<meta name=twitter:description content="Can an ensemble based on location-uncertainty generate a reliable ensemble in neural DA?">
<meta property="og:title" content="4DVarNet-LU: An neural ensemble DA model for uncertainty quantification. | Home">
<meta property="og:description" content="Can an ensemble based on location-uncertainty generate a reliable ensemble in neural DA?">
<meta property="og:type" content="article">
<meta property="og:url" content="https://shashankkroy.github.io/research-statement/uncertaitny-quantification-lu/">
<meta property="og:image" content="https://shashankkroy.github.io/research-statement/uncertaitny-quantification-lu/images/4dvarnet-lu.png"><meta property="article:section" content="research-statement">
<meta property="article:published_time" content="2025-11-25T00:00:00+00:00">
<meta property="article:modified_time" content="2025-11-25T00:00:00+00:00"><meta property="og:site_name" content="Webpage">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Research Statement","item":"https://shashankkroy.github.io/research-statement/"},{"@type":"ListItem","position":2,"name":"4DVarNet-LU: An neural ensemble DA model for uncertainty quantification.","item":"https://shashankkroy.github.io/research-statement/uncertaitny-quantification-lu/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"4DVarNet-LU: An neural ensemble DA model for uncertainty quantification. | Home","name":"4DVarNet-LU: An neural ensemble DA model for uncertainty quantification.","description":"Can an ensemble based on location-uncertainty generate a reliable ensemble in neural DA?","keywords":["machine learning, neural networks, uncertainty quantification, AI"],"wordCount":"519","inLanguage":"en","image":"https://shashankkroy.github.io/research-statement/uncertaitny-quantification-lu/images/4dvarnet-lu.png","datePublished":"2025-11-25T00:00:00Z","dateModified":"2025-11-25T00:00:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://shashankkroy.github.io/research-statement/uncertaitny-quantification-lu/"},"publisher":{"@type":"Organization","name":"Home","logo":{"@type":"ImageObject","url":"https://shashankkroy.github.io/favicon.ico"}}}</script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css integrity=sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0 crossorigin=anonymous>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js integrity=sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4 crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:!0},{left:'$',right:'$',display:!1},{left:'\\(',right:'\\)',display:!1},{left:'\\[',right:'\\]',display:!0}],throwOnError:!1})})</script>
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary-bg:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list-page{background:var(--theme)}.list-page:not(.dark)::-webkit-scrollbar-track{background:0 0}.list-page:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript>
</head>
<body class="type-research-statement kind-page layout-" id=top><script data-no-instant>function switchTheme(a){switch(a){case'light':document.body.classList.remove('dark');break;case'dark':document.body.classList.add('dark');break;default:window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')}}function isDarkTheme(){return document.body.className.includes("dark")}function getPrefTheme(){return localStorage.getItem("pref-theme")}function setPrefTheme(a){switchTheme(a),localStorage.setItem("pref-theme",a)}const toggleThemeCallbacks={};toggleThemeCallbacks.main=a=>{a?setPrefTheme('light'):setPrefTheme('dark')},window.addEventListener('toggle-theme',function(){const a=isDarkTheme();for(const b in toggleThemeCallbacks)toggleThemeCallbacks[b](a)});function toggleThemeListener(){window.dispatchEvent(new CustomEvent('toggle-theme'))}</script>
<script>(function(){const b='auto',a=getPrefTheme(),c=a||b;switchTheme(c)})()</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://shashankkroy.github.io/ accesskey=h title="Home (Alt + H)">Home</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://shashankkroy.github.io/about/ title="About Me">About Me
</a>
</li>
<li>
<a href=https://shashankkroy.github.io/research-statement/ title="Research Statement" class=active>Research Statement
</a>
</li>
<li>
<a href=https://shashankkroy.github.io/curriculum-vitae/ title=CV>CV
</a>
</li>
<li>
<a href=https://shashankkroy.github.io/posts/ title=Posts>Posts
</a>
</li>
<li>
<a href=https://shashankkroy.github.io/tags/ title=tags>tags
</a>
</li>
<li>
<a href=https://shashankkroy.github.io/categories/ title=categories>categories
</a>
</li>
</ul>
</nav>
</header>
<main class="main post">
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://shashankkroy.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://shashankkroy.github.io/research-statement/>Research Statement</a></div><h1 class=post-title>4DVarNet-LU: An neural ensemble DA model for uncertainty quantification.</h1>
<div class=post-description>Can an ensemble based on location-uncertainty generate a reliable ensemble in neural DA?</div>
<div class=post-meta><span class=meta-item><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar" style="user-select:text"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" style="user-select:text"/><line x1="16" y1="2" x2="16" y2="6" style="user-select:text"/><line x1="8" y1="2" x2="8" y2="6" style="user-select:text"/><line x1="3" y1="10" x2="21" y2="10" style="user-select:text"/></svg>
<span>November 25, 2025</span></span><span class=meta-item><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon" style="user-select:text"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z" style="user-select:text"/><line x1="7" y1="7" x2="7" y2="7" style="user-select:text"/></svg>
<span class=post-tags><a href=https://shashankkroy.github.io/tags/machine-learning-neural-networks-uncertainty-quantification-ai/>machine learning, neural networks, uncertainty quantification, AI</a></span></span><span class=meta-item><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text" style="user-select:text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z" style="user-select:text"/><polyline points="14 2 14 8 20 8" style="user-select:text"/><line x1="16" y1="13" x2="8" y2="13" style="user-select:text"/><line x1="16" y1="17" x2="8" y2="17" style="user-select:text"/><polyline points="10 9 9 9 8 9" style="user-select:text"/></svg>
<span>519 words</span></span><span class=meta-item><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>3 min</span></span>
</div>
</header> <div class="toc side right">
<details open>
<summary accesskey=c title="(Alt + C)">
<span class=details>Table of Contents</span>
</summary>
<div class=inner><nav id=TableOfContents>
<ul>
<li><a href=#the-story-so-far>The story so far</a></li>
<li><a href=#uncertanty-quantification-using-spatiotemporal-random-displacements>Uncertanty quantification using spatiotemporal random displacements</a></li>
<li><a href=#4dvarnet-lu-an-ensemble-neural-data-assimilation-model>4DVarNet-LU: An ensemble neural data assimilation model</a></li>
<li><a href=#so-what-does-the-4dvarnet-lu-model-predicts>So what does the 4DVarNet-LU model predicts?</a></li>
<li><a href=#references>References</a></li>
</ul>
</nav>
</div>
</details>
</div>
<div class=post-content><h2 id=the-story-so-far>The story so far<a hidden class=anchor aria-hidden=true href=#the-story-so-far>¶</a></h2>
<p>Modern geophysical systems are dominated by coherent structures: jets, eddies, fronts, filaments, and sharp interfaces. In such systems, forecast errors are rarely pointwise or purely additive. Instead, they are primarily structural and geometric, arising from uncertainties in the position, shape, and evolution of these coherent features.</p>
<p>Classical variational data assimilation and recent neural approaches (including 4DVarNet) have demonstrated strong performance in deterministic state reconstruction. However, they typically produce a single optimal trajectory, providing limited insight into uncertainty, especially uncertainty driven by displacement and phase errors.</p>
<p>At the same time, ensemble-based methods often rely on simplistic perturbation strategies (e.g. additive Gaussian noise) that fail to consider non-gaussian error structures such as alignment or positional errors. Such perturbations distort coherent structures, inject unphysical small-scale energy, and poorly represent the dominant error subspaces of advective systems.</p>
<p>This project is motivated by a simple but fundamental observation:
<em>In geophysical fluids, uncertainty propagates primarily through large-scale displacements of coherent structures, while small-scale features are advected and deformed by those displacements.</em></p>
<h2 id=uncertanty-quantification-using-spatiotemporal-random-displacements>Uncertanty quantification using spatiotemporal random displacements<a hidden class=anchor aria-hidden=true href=#uncertanty-quantification-using-spatiotemporal-random-displacements>¶</a></h2>
<p>We introduce an uncertainty model based on spatiotemporally correlated random displacement fields, inspired by stochastic fluid dynamics and Lagrangian flow theory.</p>
<p>Instead of perturbing state variables directly, we model uncertainty through a stochastic flow of diffeomorphisms that acts on the state via transport. These random flows:</p>
<ul>
<li>Are smooth and large-scale, targeting the dominant coherent structures</li>
<li>Are temporally correlated, reflecting finite predictability horizons</li>
<li>Preserve the geometric integrity of advected fields</li>
<li>Induce realistic small-scale variability through shear and deformation</li>
</ul>
<p>Formally, uncertainty is represented by a stochastic displacement field whose statistics are controlled in both space (scale-selective spectra) and time (Ornstein–Uhlenbeck dynamics). This construction allows us to explicitly separate:</p>
<p>Large-scale position uncertainty (phase errors)</p>
<p>Small-scale residual variability (amplitude errors)</p>
<h2 id=4dvarnet-lu-an-ensemble-neural-data-assimilation-model>4DVarNet-LU: An ensemble neural data assimilation model<a hidden class=anchor aria-hidden=true href=#4dvarnet-lu-an-ensemble-neural-data-assimilation-model>¶</a></h2>
<p><img loading=lazy src=/images/4dvarnet-lu.png type alt="4DVarNet Architecture"></p>
<p>Building on this uncertainty framework, we introduce 4DVarNet-LU, an ensemble extension of 4DVarNet designed to handle Lagrangian uncertainty (LU).</p>
<p>In 4DVarNet-LU:</p>
<ul>
<li>Each ensemble member is generated by applying a stochastic displacement flow to the initial state</li>
<li>All ensemble members are then assimilated using a shared neural variational architecture</li>
<li>The ensemble is flow-dependent, structured, and physically meaningful by construction.</li>
</ul>
<p>4DVarNet-LU embeds uncertainty within the architecture itself during generation of initial state, allowing the neural solver to generate multiple reconstructions states.</p>
<h2 id=so-what-does-the-4dvarnet-lu-model-predicts>So what does the 4DVarNet-LU model predicts?<a hidden class=anchor aria-hidden=true href=#so-what-does-the-4dvarnet-lu-model-predicts>¶</a></h2>
<p>The 4DVarNet-LU model can predicts an ensemble of reconstructed state trajectories, not a single deterministic solution, given a sequence of observations over an assimilation window.
This makes 4DVarNet-LU particularly well-suited for applications involving coherent advective structures, where positional uncertainty dominates the amplitude uncertainty.</p>
<h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>¶</a></h2>
<ul>
<li>
<p>Fablet, R., Drumetz, L., Rousseau, F. (2021). Learning variational data assimilation models and solvers. Journal of Advances in Modeling Earth Systems.</p>
</li>
<li></li>
<li>
<p>Beauchamp, M., Fablet, R., et al. (2023). Neural variational data assimilation with learned dynamical priors.</p>
</li>
<li>
<p>Beck, A., et al. (2009). Morphing ensemble Kalman filters. Tellus A.</p>
</li>
<li>
<p>Lawson, W. G., Hansen, J. A. (2005). Implications of stochastic and deterministic filters. Monthly Weather Review.</p>
</li>
<li>
<p>Holm, D. D. (2015). Variational principles for stochastic fluid dynamics. Proceedings of the Royal Society A.</p>
</li>
<li>
<p>Vallis, G. K. (2017). Atmospheric and Oceanic Fluid Dynamics. Cambridge University Press.</p>
</li>
</ul>
</div>
<footer class=post-footer>
<nav class=paginav>
<a class=next href=https://shashankkroy.github.io/research-statement/neural-data-assimilation/>
<span class=title>Next Page&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right" style="user-select:text"><line x1="5" y1="12" x2="19" y2="12" style="user-select:text"/><polyline points="12 5 19 12 12 19" style="user-select:text"/></svg>
</span>
<br>
<span>4DVarNet: A neural network based on variational data assimilation</span>
</a>
</nav>
</footer>
</article>
</main>
<footer class=footer>
<span>&copy; 2026 <a href=https://shashankkroy.github.io/>Home</a></span><span style=display:inline-block;margin-left:1em>
<a href=https://creativecommons.org/licenses/by-sa/4.0/>CC BY-SA</a>
</span>
<span style=display:inline-block;margin-left:1em>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
    <a href=https://github.com/reorx/hugo-PaperModX/ rel=noopener target=_blank>PaperModX</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>(function(){const b=''=='1';if(b)return;let a=document.getElementById("theme-toggle");a.removeEventListener('click',toggleThemeListener),a.addEventListener('click',toggleThemeListener)})()</script>
<script>(function(){let a=document.getElementById('menu');a&&(a.scrollLeft=localStorage.getItem("menu-scroll-position"),a.onscroll=function(){localStorage.setItem("menu-scroll-position",a.scrollLeft)});const b=''=='1',c=''=='1';if(window.matchMedia('(prefers-reduced-motion: reduce)').matches||b||c)return;document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})})()</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>if(window.scrollListeners)for(const a of scrollListeners)window.removeEventListener('scroll',a);window.scrollListeners=[]</script>
<script src=/js/medium-zoom.min.js data-no-instant></script>
<script>(function(){const h='1'=='1';if(!h)return;if(!document.querySelector('.toc')){console.log('no toc found, ignore toc scroll');return}const i=window.scrollListeners,c=document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id]'),d='active';let a=c[0];e(a).classList.add(d);const g=()=>{const b=[];for(const a of c)if(j(a)<5)b.push(a);else break;b.length>0?newActiveHeading=b[b.length-1]:newActiveHeading=c[0],a!=newActiveHeading&&(e(a).classList.remove(d),a=newActiveHeading,e(a).classList.add(d))};let b=null;const f=()=>{b!==null&&clearTimeout(b),b=setTimeout(g,50)};window.addEventListener('scroll',f,!1),i.push(f);function e(a){const b=encodeURI(a.getAttribute('id')).toLowerCase();return document.querySelector(`.toc ul li a[href="#${b}"]`)}function j(a){if(!a.getClientRects().length)return 0;let b=a.getBoundingClientRect();return b.top}})()</script>
</body>
</html>